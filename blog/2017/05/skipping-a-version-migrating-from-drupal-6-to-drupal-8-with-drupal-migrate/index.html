<!DOCTYPE html>
<!--[if IE 8]>         <html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <title>Skipping a Version - Migrating from Drupal 6 to Drupal 8 with Drupal Migrate | ThinkShout</title>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, minimum-scale=0.5 maximum-scale=1.0">
  <meta name="format-detection" content="telephone=no">

  
  <meta name="description" content="The differences between Drupal 6 and Drupal 8 are pretty major, but thankfully, making the jump is singificantly easier with Drupal Migrate.">

  <!-- Social Media Metatags -->
  
  <meta property="og:image" content="https://thinkshout.com/assets/images/ts_icon.jpg">
  <meta name="twitter:image" content="https://thinkshout.com/assets/images/ts_icon.jpg">
  

  
  <meta name="keywords" content="Drupal, Drupal Planet, Migrate">

  <!-- Fonts -->
  <link rel="stylesheet" type="text/css" href="//cloud.typography.com/6630094/7238952/css/fonts.css" />
  <link rel="stylesheet" type="text/css" href="/assets/fonts/MyFontsWebfontsKit.css" />

  <link rel="shortcut icon" href="/assets/images/assets/favicon.ico" type="image/vnd.microsoft.icon" />

  <!-- Normalize CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.3/normalize.min.css" media="screen" title="no title" />

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css?v=2018-06-11.11.49.44" />

  <!-- RSS feed -->
  <link rel="alternate" type="application/rss+xml" title="ThinkShout Feed" href="/rss.xml" />
</head>
<body class="blog-post">

  <!-- Header -->
  <header>
  <div class="container">
    <div class="header-logo">
      <a href="/">
        <img src="/assets/images/ts_redesign/ts-logo-full.png" alt="ThinkShout logo" />
      </a>
    </div>

    <a class="mobile-menu-icon">
      <div>
        <span aria-hidden="false">Menu</span>
      </div>
    </a>

		<nav>
			<ul class="main-menu">
        
          
            <li><a href="/work/">Our Work</a></li>
          
        
          
            <li><a href="/services/">Services</a></li>
          
        
          
            <li><a href="/values/">Values</a></li>
          
        
          
            <li><a href="/team/">Team</a></li>
          
        
          
            <li><a href="/blog/">Blog</a></li>
          
        
          
        
          
        
			</ul>
		</nav>
	</div>
</header>


  <!-- Main Content -->
  <div class="main-content">
      <div class="blog-header">
  

  <p><span class="date">05.19.2017</span>
  
    
      
    
      
    
      
    
      
        <a class="topic" href="/blog/topic/technology">Technology and Innovation</a>
      
    
  
  </p>

  <h1 class="post-title">Skipping a Version - Migrating from Drupal 6 to Drupal 8 with Drupal Migrate</h1>
  <p class="byline">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <img class="team-photo" src="/assets/images/team/small/dan.jpg">
    
      <a class="team-name" href="/team/dan/">Dan Ruscoe</a>
    <br>
      Senior Software Engineer
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
  </p>
</div>





<section class="body">
  <p>I recently had the opportunity to migrate content from a Drupal 6 site to a Drupal 8 site. This was especially interesting for me as I hadn’t used Drupal 6 before. As you’d expect, there are some major infrastructure changes between Drupal 6 and Drupal 8. Those differences introduce some migration challenges that I’d like to share.</p>

<p>The <a href="https://www.drupal.org/project/migrate">Migrate module</a> is a wonderful thing.  The vast majority of node-based content can be migrated into a Drupal 8 site with minimal effort, and for the content that doesn’t quite fit, there are custom migration sources. A custom migration source is a small class that can provide extra data to your migration in the form of source fields. Typically, a migration will map source fields to destination fields, expecting the fields to exist on both the source node type and destination node type. We actually published an in-depth, <a href="https://thinkshout.com/blog/2017/01/using-google-docs-and-migrate-to-populate-your-drupal-site-part-1/">two-part blog series about how we use Drupal Migrate</a> to populate Drupal sites with content in conjunction with Google Sheets in our own projects.</p>

<p>In the following example, we are migrating the value of content_field_text_author from Drupal 6 to field_author in Drupal 8. These two fields map one-to-one:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">id</span><span class="pi">:</span> <span class="s">book</span>
<span class="na">label</span><span class="pi">:</span> <span class="s">Book</span>
<span class="na">migration_group</span><span class="pi">:</span> <span class="s">d6</span>
<span class="na">deriver</span><span class="pi">:</span> <span class="s">Drupal\node\Plugin\migrate\D6NodeDeriver</span>
<span class="na">source</span><span class="pi">:</span>
  <span class="na">key</span><span class="pi">:</span> <span class="s">migrate</span>
  <span class="na">target</span><span class="pi">:</span> <span class="s">d6</span>
  <span class="na">plugin</span><span class="pi">:</span> <span class="s">d6_node</span>
  <span class="na">node_type</span><span class="pi">:</span> <span class="s">book</span>
<span class="na">process</span><span class="pi">:</span>
  <span class="na">field_author</span><span class="pi">:</span> <span class="s">content_field_text_author</span>
<span class="na">destination</span><span class="pi">:</span>
  <span class="na">plugin</span><span class="pi">:</span> <span class="s">entity:node</span>
</code></pre></div></div>

<p>This field mapping works because content_field_text_author is a table in the Drupal 6 database and is recognized by the Migrate module as a field. Everyone is happy.</p>

<p>However, in Drupal 6, it’s possible for a field to exist only in the database table of the node type. These tables look like this:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">DESC</span> <span class="n">content_type_book</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------------------------+------------------+------+-----+---------+-------+</span>
<span class="o">|</span> <span class="n">Field</span>                      <span class="o">|</span> <span class="k">Type</span>             <span class="o">|</span> <span class="k">Null</span> <span class="o">|</span> <span class="k">Key</span> <span class="o">|</span> <span class="k">Default</span> <span class="o">|</span> <span class="n">Extra</span>  <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+------------------+------+-----+---------+-------+</span>
<span class="o">|</span> <span class="n">vid</span>                        <span class="o">|</span> <span class="n">int</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">unsigned</span> <span class="o">|</span> <span class="k">NO</span>   <span class="o">|</span> <span class="n">PRI</span> <span class="o">|</span> <span class="mi">0</span>             <span class="o">|</span>   <span class="o">|</span>
<span class="o">|</span> <span class="n">nid</span>                        <span class="o">|</span> <span class="n">int</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">unsigned</span> <span class="o">|</span> <span class="k">NO</span>   <span class="o">|</span> <span class="n">MUL</span> <span class="o">|</span> <span class="mi">0</span>           <span class="o">|</span>   <span class="o">|</span>
<span class="o">|</span> <span class="n">field_text_issue_value</span>     <span class="o">|</span> <span class="n">longtext</span>         <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="k">NULL</span> <span class="o">|</span>   <span class="o">|</span>
<span class="o">+</span><span class="c1">----------------------------+------------------+------+-----+---------+-------+</span>
</code></pre></div></div>

<p>If we want to migrate the content of field_text_issue_value to Drupal 8, we need to use a custom migration source.</p>

<p>Custom migration sources are PHP classes that live in the src/Plugin/migrate/source directory of your module. For example, you may have a PHP file located at src/Plugin/migrate/source/BookNode.php that would provide custom source fields for a Book content type.</p>

<p>A simple source looks like this:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="nx">Drupal\custom_migrate_d6\Plugin\migrate\source</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Drupal\node\Plugin\migrate\source\d6\Node</span><span class="p">;</span>

<span class="sd">/**
 * @MigrateSource(
 *   id = "d6_book_node",
 * )
 */</span>
<span class="k">class</span> <span class="nc">BookNode</span> <span class="k">extends</span> <span class="nx">Node</span> <span class="p">{</span>

  <span class="sd">/**
   * @inheritdoc
   */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">query</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="k">parent</span><span class="o">::</span><span class="na">query</span><span class="p">();</span>

    <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">join</span><span class="p">(</span><span class="s1">'content_type_book'</span><span class="p">,</span> <span class="s1">'book'</span><span class="p">,</span> <span class="s1">'n.nid = book.nid'</span><span class="p">);</span>
    <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">addField</span><span class="p">(</span><span class="s1">'book'</span><span class="p">,</span> <span class="s1">'field_text_issue_value'</span><span class="p">);</span>

    <span class="k">return</span> <span class="nv">$query</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div>
<p>As you can see, we are using our migration source to modify the query the Migrate module uses to retrieve the data to be migrated. Our modification extracts the field_text_issue_value column of the book content type table and provides it to the migration as a source field.</p>

<p>To use this migration source, we need to make one minor change to change to our migration. We replace this:</p>

<p>plugin: d6_node</p>

<p>With this:</p>

<p>plugin: d6_book_node</p>

<p>We do this because our migration source extends the standard Drupal 6 node migration source in order to add our custom source field.</p>

<p>The migration now contains two source fields and looks like this:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">id</span><span class="pi">:</span> <span class="s">book</span>
<span class="na">label</span><span class="pi">:</span> <span class="s">Book</span>
<span class="na">migration_group</span><span class="pi">:</span> <span class="s">d6</span>
<span class="na">deriver</span><span class="pi">:</span> <span class="s">Drupal\node\Plugin\migrate\D6NodeDeriver</span>
<span class="na">source</span><span class="pi">:</span>
  <span class="na">key</span><span class="pi">:</span> <span class="s">migrate</span>
  <span class="na">target</span><span class="pi">:</span> <span class="s">d6</span>
  <span class="na">plugin</span><span class="pi">:</span> <span class="s">d6_book_node</span>
  <span class="na">node_type</span><span class="pi">:</span> <span class="s">book</span>
<span class="na">process</span><span class="pi">:</span>
  <span class="na">field_author</span><span class="pi">:</span> <span class="s">content_field_text_author</span>
  <span class="na">field_issue</span><span class="pi">:</span> <span class="s">field_text_issue_value</span>
<span class="na">destination</span><span class="pi">:</span>
  <span class="na">plugin</span><span class="pi">:</span> <span class="s">entity:node</span>
</code></pre></div></div>

<p>You’ll find you can do a lot with custom migration sources, and this is especially useful with legacy versions of Drupal where you’ll have to fudge data at least a little bit. So if the Migrate module isn’t doing it for you, you’ll always have the option to step in and give it a little push.</p>


  
    
      <div class="blog-cta">
        <div class="text">
          <h3>Get In Touch</h3>
          <p><p>Questions? Comments? We want to know! Drop us a line and let’s start talking.</p>
</p>
          <a href="https://thinkshout.com/contact/" class="uppercase-link">Learn More<i class="fa fa-caret-right"></i></a>
        </div>

        
        <div class="image">
          <img src="/assets/images/ts_redesign/cta/portland-waterfront-cta.jpg" alt="Get In Touch">
        </div>
        
      </div>
      

  
    <div class="tags">
      <span class="tag-label">Tags:</span>
      <a class='tag' rel='tag category' title='View all posts tagged Drupal.' href='/blog/category/drupal/'>Drupal</a> <a class='tag' rel='tag category' title='View all posts tagged Drupal Planet.' href='/blog/category/drupal-planet/'>Drupal Planet</a> <a class='tag' rel='tag category' title='View all posts tagged Migrate.' href='/blog/category/migrate/'>Migrate</a>
    </div>
  


  
<div class="comments">
  <div id="disqus_thread"></div>
  <script>
  /**
  * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
  */
  var disqus_config = function () {
    this.page.url = 'https://thinkshout.com/blog/2017/05/skipping-a-version-migrating-from-drupal-6-to-drupal-8-with-drupal-migrate/';
    this.page.identifier = '/blog/2017/05/skipping-a-version-migrating-from-drupal-6-to-drupal-8-with-drupal-migrate';
    this.page.title = 'Skipping a Version - Migrating from Drupal 6 to Drupal 8 with Drupal Migrate'
  };
  (function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');

  s.src = '//thinkshout.disqus.com/embed.js';

  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>


</section>

<div class="pagination">
  
    <div class="previous">
      <a href="/blog/2017/05/what-to-think-about-when-thinking-about-a-redesign/"><span class="fa fa-caret-left"></span> <span>What to Think About When You're Thinking About a Redesign</span></a>
    </div>
  

  
    <div class="next">
      <a href="/blog/2017/06/fade-to-black-responsive-css-gradients/"><span>Fade To Black - Responsive CSS Gradients</span> <span class="fa fa-caret-right"></span></a>
    </div>
  
</div>




  <div class="team-member-blog">
    <div class="container">
      <h4>Related Blog Posts</h4>
      <div class="row posts">
        
        
        
        
        
          <div class="post">
  <a href="/blog/2018/05/Space-for-Empathy/">
    <p class="post-date">05.24.2018</p>
    <h3 class="post-title">Space for Empathy</h3>
    <p class="post-short">How do we make space for empathy in our work and in our community? Jules takes us on a deep dive into what she learned at this year's DrupalCon</p>
    <p class="byline">
      
      <img class="team-photo" src="/assets/images/team/small/jules.jpg">
      <span class="byline-text">
        <strong>Jules Dickey</strong><br>
        <span class="position">Software Engineer</span>
      </span>
    </p>
  </a>
</div>

          
          
        
        
        
          <div class="post">
  <a href="/blog/2018/05/Making-GDPR-Preparations/">
    <p class="post-date">05.13.2018</p>
    <h3 class="post-title">Preparing for the GDPR</h3>
    <p class="post-short">The European Union’s General Data Protection Regulations go into effect May 25th. Here's how you need to prepare.</p>
    <p class="byline">
      
      <img class="team-photo" src="/assets/images/team/small/tauno.jpg">
      <span class="byline-text">
        <strong>Tauno Hogue</strong><br>
        <span class="position">Chief Technology Officer</span>
      </span>
    </p>
  </a>
</div>

          
          
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
          <div class="post">
  <a href="/blog/2018/01/Great-hoodie-mystery/">
    <p class="post-date">01.06.2018</p>
    <h3 class="post-title">The Great Hoodie Mystery</h3>
    <p class="post-short">Gabe takes what would otherwise be an inane office exchange and ties it back to data structures.</p>
    <p class="byline">
      
      <img class="team-photo" src="/assets/images/team/small/gabe.jpg">
      <span class="byline-text">
        <strong>Gabe Carleton-Barnes</strong><br>
        <span class="position">Director of Engineering</span>
      </span>
    </p>
  </a>
</div>

          
          
            
      </div>
    </div>
  </div>


  </div>

  <!-- Footer -->
  <div class="newsletter-block">
  <div class="container">
    <div class="newsletter-info">
      <h1>Get Our Email Newsletter</h1>
      <p>
        Cutting edge solutions, strategies, and updates from industry
        thought-leaders, delivered right to your inbox.
      </p>

      <form id="mc-embedded-subscribe-form" action="//thinkshout.us1.list-manage.com/subscribe/post?u=2ec82d6db8eeef3d5b33b762e&amp;id=e85720354e" method="post"  name="mc-embedded-subscribe-form" class="validate" target="_blank">
        <input type="email" placeholder="your email address" name="EMAIL" id="mce-EMAIL" required>
        <button type="submit">submit<i class="fa fa-caret-right"></i></button>
      </form>
    </div>
  </div>
</div>

  <footer>
  <div class="container">
  	<nav class="footer-menu">
      <ul class="main-menu-footer">
        
        <li>
          <a href="/work/">Our Work</a>
          
        </li>
        
        <li>
          <a href="/services/">Services</a>
          
            <ul class="footer-submenu">
            
              <li>
                <a href="/services/digital-strategy/">Digital Strategy</a>
              </li>
            
              <li>
                <a href="/services/design/">Design & UX</a>
              </li>
            
              <li>
                <a href="/services/digital-ecosystem/">Digital Ecosystem</a>
              </li>
            
              <li>
                <a href="/services/development/">Development</a>
              </li>
            
            </ul>
          
        </li>
        
        <li>
          <a href="/values/">Values</a>
          
        </li>
        
        <li>
          <a href="/team/">Team</a>
          
        </li>
        
        <li>
          <a href="/blog/">Blog</a>
          
        </li>
        
        <li>
          <a href="/contact/">Connect With Us</a>
          
        </li>
        
        <li>
          <a href="/careers/">Careers</a>
          
        </li>
        
      </ul>
  	</nav>

    <div class="bcorp-logo">
      
      
        
          <a href="https://www.bcorporation.net/community/thinkshout-inc" target="_blank">
            <img src="/assets/images/ts_redesign/bcorp.png" alt="bcorp logo" />
          </a>
        
      
    </div>

    <div class="footer-bottom">
      <div class="social-media">
        <ul>
          
            <li>
              <a href="http://www.facebook.com/ThinkShout" target="_blank">
                <img src="/assets/images/ts_redesign/facebook.svg" alt="facebook" />
              </a>
            </li>
          
            <li>
              <a href="http://www.twitter.com/ThinkShout" target="_blank">
                <img src="/assets/images/ts_redesign/twitter.svg" alt="twitter" />
              </a>
            </li>
          
        </ul>
      </div>
      <div class="copyright">
        &copy;2018 ThinkShout, Inc. ThinkShout and the ThinkShout logos are registered trademarks of ThinkShout, Inc.
        
        
          
            <a href="/privacy/">Privacy Policy</a>
          
        
      </div>
    </div>
  </div>
</footer>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js"></script>
	<script src="/assets/js/jquery.waypoints.min.js"></script>
  <script src="/assets/js/jquery.matchHeight.js"></script>
  <script src="/assets/js/chosen.jquery.min.js"></script>
  <script src="/assets/js/script.js"></script>


  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-9743130-1', 'auto');
    ga('send', 'pageview');

  </script>

</body>
</html>
